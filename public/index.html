<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://www.google-analytics.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https://link-coach.vercel.app https://www.google-analytics.com https://analytics.google.com; frame-src https://link-coach.vercel.app; frame-ancestors 'none'; base-uri 'self'; form-action 'self';">

    <!-- Security Headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta name="referrer" content="strict-origin-when-cross-origin">

    <!-- Primary Meta Tags -->
    <title>Link-Lite - 리더십 진단 & 팀 궁합 분석</title>
    <meta name="title" content="Link-Lite - 리더십 진단 & 팀 궁합 분석">
    <meta name="description" content="20개 간단한 질문으로 나의 리더십 스타일을 확인하고 팀원들과 더 잘 소통하는 방법을 알아보세요. SIG 모델 기반 링커십 진단 도구.">
    <meta name="keywords" content="리더십, 진단, 팀 궁합, 링커십, SIG 모델, 팔로워십, 팀 관리, 리더십 테스트">
    <meta name="author" content="Link-Lite">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://link-lite.netlify.app/">
    <meta property="og:title" content="Link-Lite - 리더십 진단 & 팀 궁합 분석">
    <meta property="og:description" content="20개 간단한 질문으로 나의 리더십 스타일을 확인하고 팀원들과 더 잘 소통하는 방법을 알아보세요.">
    <meta property="og:image" content="https://link-lite.netlify.app/og-image.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://link-lite.netlify.app/">
    <meta property="twitter:title" content="Link-Lite - 리더십 진단 & 팀 궁합 분석">
    <meta property="twitter:description" content="20개 간단한 질문으로 나의 리더십 스타일을 확인하고 팀원들과 더 잘 소통하는 방법을 알아보세요.">
    <meta property="twitter:image" content="https://link-lite.netlify.app/og-image.png">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="alternate icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon.svg">

    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T1NCMF2HJH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        // GA4 Configuration
        gtag('config', 'G-T1NCMF2HJH', {
            'anonymize_ip': true,
            'cookie_flags': 'SameSite=None;Secure',
            'send_page_view': false  // Manual page view tracking via AnalyticsManager
        });

        // Custom dimensions for enhanced tracking
        gtag('set', 'user_properties', {
            'app_version': '2.0.0',
            'platform': 'web'
        });

        // Logger will be available after logger.js loads
        if (typeof logger !== 'undefined') {
            logger.log('📊 Google Analytics 4 initialized');
        }
    </script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"></noscript>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="mobile-native.css?v=1764003976">
    <link rel="stylesheet" href="premium-style.css?v=1764005355">
    <link rel="stylesheet" href="mobile-font-system.css?v=1">

    <!-- Theme Color -->
    <meta name="theme-color" content="#8b5cf6">

    <!-- Critical CSS for initial render -->
    <style>
        body {
            margin: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        .premium-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body class="welcome-page">
    <div class="premium-container" role="main" aria-label="링커십 진단 애플리케이션">
        <div class="glass-card" style="max-width: 900px; width: 100%; margin-left: auto; margin-right: auto;">
            <header class="glass-header" role="banner">
                <h1>Link-Lite</h1>
                <p class="subtitle">간편한 리더십 진단 & 팀 궁합 체크</p>
            </header>

            <div class="premium-content" role="main">
                <!-- 시작 화면 -->
                <div id="welcome" class="premium-section active" role="region" aria-label="시작 화면">
                    <div class="welcome-section">
                        <h2 class="welcome-title">일일이 챙겨야 팀이 움직이나요?</h2>
                        <p class="welcome-subtitle">AI 시대 새로운 리더십, 링커십(Linkership)</p>
                        <p class="welcome-description">
                            강한 지시보다 단단한 연결이 팀을 움직입니다.<br>
                            짧은 참여로 나의 링커십과 팔로워십을 확인하고,<br>
                            팀 실행력을 높일 인사이트를 발견하세요.
                        </p>

                        <div class="feature-grid" role="list" aria-label="진단 기능">
                            <div class="feature-item" role="listitem">
                                <div class="feature-icon-modern analytics" aria-hidden="true"></div>
                                <div class="feature-content">
                                    <h3 class="feature-title">SIG 모델 진단</h3>
                                    <p class="feature-description">공유·상호작용·성장 영역 분석</p>
                                </div>
                            </div>
                            <div class="feature-item" role="listitem">
                                <div class="feature-icon-modern collaboration" aria-hidden="true"></div>
                                <div class="feature-content">
                                    <h3 class="feature-title">팔로워십 매칭</h3>
                                    <p class="feature-description">팀원 유형별 맞춤 코칭 전략</p>
                                </div>
                            </div>
                            <div class="feature-item" role="listitem">
                                <div class="feature-icon-modern insights" aria-hidden="true"></div>
                                <div class="feature-content">
                                    <h3 class="feature-title">링커십 전환</h3>
                                    <p class="feature-description">연결자로서의 실행 가이드</p>
                                </div>
                            </div>
                        </div>

                        <button class="premium-btn" id="startBtn" aria-label="리더십 진단 시작하기">
                            <span>진단 시작</span>
                            <span aria-hidden="true">→</span>
                        </button>
                    </div>
                </div>

                <!-- 진단 화면 -->
                <div id="assessment" class="premium-section" role="region" aria-label="진단 화면">
                    <div class="premium-progress" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" aria-label="진단 진행률">
                        <div class="premium-progress-fill" id="progressBar"></div>
                    </div>

                    <div class="premium-question-card" role="form" aria-label="리더십 진단 질문">
                        <div class="question-meta">
                            <div class="question-number" id="questionNumber" aria-live="polite"></div>
                        </div>

                        <div class="question-text" id="questionText" aria-live="polite"></div>

                        <div id="interactiveInput" role="group" aria-label="점수 선택"></div>
                    </div>

                    <nav class="premium-nav" role="navigation" aria-label="진단 네비게이션">
                        <button class="premium-btn premium-btn-secondary" id="prevBtn" disabled aria-label="이전 질문으로 이동">
                            <span aria-hidden="true">←</span> 이전
                        </button>
                        <button class="premium-btn" id="nextBtn" disabled aria-label="다음 질문으로 이동">
                            <span id="nextBtnText">다음</span>
                            <span aria-hidden="true">→</span>
                        </button>
                    </nav>
                </div>

                <!-- 팔로워십 선택 화면 -->
                <div id="followership" class="premium-section" role="region" aria-label="팔로워십 선택 화면">
                    <div class="followership-selection">
                        <div class="section-header">
                            <h2 class="section-title">팀원의 팔로워십 유형을 선택하세요</h2>
                            <p class="section-description">팀원의 유형에 따라 리더십 궁합과 맞춤형 코칭 전략을 제시합니다.<br>최소 1명 이상의 팀원을 선택해주세요.</p>
                        </div>

                        <div class="followership-grid" id="followershipOptionsPage" role="group" aria-label="팔로워십 유형 선택"></div>

                        <nav class="premium-nav" style="margin-top: var(--space-10);" role="navigation" aria-label="팔로워십 네비게이션">
                            <button class="premium-btn premium-btn-secondary" id="backToAssessmentBtn" aria-label="진단 화면으로 돌아가기">
                                <span aria-hidden="true">←</span> 이전
                            </button>
                            <button class="premium-btn" id="showResultsBtn" disabled aria-label="진단 결과 보기">
                                <span>결과 보기</span>
                                <span aria-hidden="true">→</span>
                            </button>
                        </nav>
                    </div>
                </div>

                <!-- 결과 화면 -->
                <div id="results" class="premium-section" role="region" aria-label="진단 결과 화면">
                    <div class="premium-results">
                        <!-- 1. 나의 리더십 특징 -->
                        <section class="results-section">
                            <h2 class="results-main-title">나의 리더십 특징</h2>
                            <p class="results-intro">평소 팀과의 상호작용 패턴을 분석하여, 현재 강점과 보완이 필요한 영역을 파악했습니다.</p>

                            <div class="leadership-type-card">
                                <div class="leadership-card-header">
                                    <div class="leadership-type-info">
                                        <h3 class="leadership-type" id="leadershipType"></h3>
                                        <p class="leadership-subtitle" id="leadershipSubtitle"></p>
                                    </div>
                                </div>

                                <!-- 그래프와 점수 카드 통합 -->
                                <div class="leadership-chart-section">
                                    <div class="radar-chart-wrapper">
                                <svg id="radarChart" class="radar-chart" viewBox="0 0 400 440" role="img" aria-labelledby="radarChartTitle radarChartDesc">
                                    <title id="radarChartTitle">리더십 점수 레이더 차트</title>
                                    <desc id="radarChartDesc">SIG 모델 기반 리더십 점수를 나타내는 레이더 차트입니다. Sharing(공유), Interaction(상호작용), Growth(성장) 세 가지 차원의 점수가 표시됩니다.</desc>
                                    <!-- 배경 그리드 -->
                                    <g class="radar-grid" transform="translate(0, 25)">
                                        <!-- 동심원들 (1점~6점) -->
                                        <circle cx="200" cy="200" r="32" class="grid-circle" />   <!-- 2점 -->
                                        <circle cx="200" cy="200" r="64" class="grid-circle" />   <!-- 3점 -->
                                        <circle cx="200" cy="200" r="96" class="grid-circle" />   <!-- 4점 -->
                                        <circle cx="200" cy="200" r="128" class="grid-circle" />  <!-- 5점 -->
                                        <circle cx="200" cy="200" r="160" class="grid-circle" />  <!-- 6점 -->
                                        <!-- 축선들 -->
                                        <!-- Sharing 축 (위쪽 -90도) -->
                                        <line x1="200" y1="200" x2="200.00" y2="40.00" class="grid-line" />
                                        <!-- Interaction 축 (오른쪽 아래 30도) -->
                                        <line x1="200" y1="200" x2="338.56" y2="280.00" class="grid-line" />
                                        <!-- Growth 축 (왼쪽 아래 150도) -->
                                        <line x1="200" y1="200" x2="61.44" y2="280.00" class="grid-line" />
                                    </g>

                                    <!-- 점수 영역 -->
                                    <g transform="translate(0, 25)">
                                        <polygon id="scoreArea" class="score-area" />

                                        <!-- 점수 포인트들 -->
                                        <g class="score-points">
                                            <circle id="sharingPoint" class="score-point sharing" r="6" />
                                            <circle id="interactionPoint" class="score-point interaction" r="6" />
                                            <circle id="growthPoint" class="score-point growth" r="6" />
                                        </g>
                                    </g>

                                    <!-- 레이블들 -->
                                    <g class="radar-labels">
                                        <text x="200" y="25" text-anchor="middle" class="radar-label">
                                            <tspan x="200" dy="0">Sharing</tspan>
                                            <tspan x="200" dy="22" class="label-desc">공유</tspan>
                                        </text>
                                        <text x="350" y="330" text-anchor="middle" class="radar-label">
                                            <tspan x="350" dy="0">Interaction</tspan>
                                            <tspan x="350" dy="22" class="label-desc">상호작용</tspan>
                                        </text>
                                        <text x="45" y="330" text-anchor="middle" class="radar-label">
                                            <tspan x="45" dy="0">Growth</tspan>
                                            <tspan x="45" dy="22" class="label-desc">성장</tspan>
                                        </text>
                                    </g>

                                </svg>
                            </div>
                        </div>

                                <!-- 강점과 주의사항 -->
                                <div class="leadership-details">
                                    <div class="detail-section strength-section">
                                        <h4 class="detail-title">
                                            <span class="detail-title-icon">✓</span>
                                            강점
                                        </h4>
                                        <ul id="leadershipStrengths" class="detail-list"></ul>
                                    </div>
                                    <div class="detail-section caution-section">
                                        <h4 class="detail-title">
                                            <span class="detail-title-icon">⚠</span>
                                            주의
                                        </h4>
                                        <ul id="leadershipCautions" class="detail-list"></ul>
                                    </div>
                                </div>
                            </div>

                        </section>

                        <!-- 나의 리더십 더 알아보기 -->
                        <section class="results-section">
                            <h2 class="results-main-title">나의 리더십 더 알아보기</h2>
                            <p class="results-intro" id="leadershipMoreIntro"></p>

                            <div class="leadership-tips-container" id="leadershipTipsContainer">
                                <!-- 동적으로 생성될 아코디언 버튼들 -->
                            </div>
                        </section>

                        <!-- 2. 팀 궁합 분석 맛보기 -->
                        <section class="results-section">
                            <h2 class="results-main-title">팀 궁합 분석 맛보기</h2>
                            <p class="results-intro">선택하신 팀원들의 팔로워십 유형과 리더십 궁합을 분석했습니다.</p>

                            <div id="compatibilityList" class="compatibility-list-container"></div>
                        </section>

                        <!-- 3. 통합 CTA -->
                        <section class="results-section final-cta-section">
                            <div class="full-version-cta-unified">
                                <div class="cta-header-line"></div>
                                <h3 class="cta-main-title">팀 기반 성장을 위한 조직 문화 조성에 관심이 있으신가요?</h3>
                                <p class="cta-main-desc">팀과 함께하는 Link 팀 진단 참여를 통해 우리 만의 팀 문화 조성을 위한 방향성을 알아보세요!</p>

                                <div class="cta-dual-columns">
                                    <div class="cta-column">
                                        <h4 class="cta-column-title">Link 팀 진단 주요 내용</h4>
                                        <ul class="cta-list-unified">
                                            <li>팀 기반 성장 촉진을 위한 현재 우리 팀의 강점/개선점</li>
                                            <li>팀 몰입도 수준</li>
                                            <li>나의 리더십 특징과 유의점 Tip</li>
                                        </ul>
                                    </div>
                                    <div class="cta-column">
                                        <h4 class="cta-column-title">팀 구성원 팔로워십 분석</h4>
                                        <ul class="cta-list-unified">
                                            <li>팀 구성원의 팔로워십 유형</li>
                                            <li>우리 팀의 팔로워십 맵</li>
                                            <li>나의 리더십 스타일 X 팔로워십 스타일별 코칭 팁 및 유의점</li>
                                        </ul>
                                    </div>
                                </div>

                                <button class="cta-button-primary" id="openInquiryBtn" aria-label="Link 팀 진단 상담 신청하기">
                                    <span>Link 팀 진단 알아보기</span>
                                    <span class="cta-arrow" aria-hidden="true">→</span>
                                </button>
                            </div>
                        </section>

                        <!-- 하단 푸터 영역 -->
                        <footer class="results-footer" role="contentinfo">
                            <div class="footer-content">
                                <button class="retake-link" id="retakeBtn" aria-label="진단 다시 시작하기">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                                        <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                                        <path d="M3 3v5h5"/>
                                    </svg>
                                    다시 진단하기
                                </button>
                                <div class="footer-divider"></div>
                                <p class="footer-brand">Link-Lite</p>
                                <p class="footer-tagline">팀 기반 성장을 위한 리더십 진단</p>
                            </div>
                        </footer>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Link 팀 진단 문의 모달 -->
    <div id="inquiryModal" class="inquiry-modal" role="dialog" aria-labelledby="inquiryTitle" aria-modal="true">
        <div class="inquiry-modal-content">
            <button class="inquiry-modal-close" id="closeInquiryBtn" aria-label="문의 창 닫기">&times;</button>

            <form id="inquiryForm" class="inquiry-form" name="team-inquiry" method="POST" data-netlify="true" netlify-honeypot="bot-field">
                <input type="hidden" name="form-name" value="team-inquiry">
                <!-- Honeypot for spam protection -->
                <p style="display: none;">
                    <label>Don't fill this out: <input name="bot-field"></label>
                </p>

                <h3 class="inquiry-title" id="inquiryTitle">Link 팀 진단 상담 신청</h3>
                <p class="inquiry-desc">관심을 가져주셔서 감사합니다. 아래 정보를 남겨주시면 담당자가 연락드리겠습니다.</p>

                <div class="inquiry-field">
                    <label for="inquiryEmail">이메일 <span class="required">*</span></label>
                    <input type="email" id="inquiryEmail" name="email" placeholder="example@company.com" required>
                </div>

                <div class="inquiry-field">
                    <label for="inquiryName">이름</label>
                    <input type="text" id="inquiryName" name="name" placeholder="홍길동">
                </div>

                <div class="inquiry-field">
                    <label for="inquiryPhone">전화번호</label>
                    <input type="tel" id="inquiryPhone" name="phone" placeholder="010-1234-5678">
                </div>

                <div class="inquiry-field">
                    <label for="inquiryCompany">회사/조직명</label>
                    <input type="text" id="inquiryCompany" name="company" placeholder="회사명">
                </div>

                <div class="inquiry-field">
                    <label for="inquiryTeamSize">팀 규모</label>
                    <select id="inquiryTeamSize" name="teamSize">
                        <option value="">선택해주세요</option>
                        <option value="1-5">1-5명</option>
                        <option value="6-10">6-10명</option>
                        <option value="11-20">11-20명</option>
                        <option value="21-50">21-50명</option>
                        <option value="50+">50명 이상</option>
                    </select>
                </div>

                <div class="inquiry-consent">
                    <label class="consent-checkbox">
                        <input type="checkbox" id="inquiryConsent" name="consent" checked>
                        <span class="consent-text">
                            맞춤형 상담을 위해 진단 결과를 함께 전달합니다
                            <button type="button" class="consent-detail-btn" id="consentDetailBtn">상세보기</button>
                        </span>
                    </label>
                    <div id="consentDetail" class="consent-detail" style="display: none;">
                        <p>수집 정보: 리더십 유형, SIG 점수</p>
                        <p>이용 목적: 맞춤형 팀 진단 상담 제공</p>
                        <p>보유 기간: 상담 완료 후 1년</p>
                    </div>
                </div>

                <!-- Hidden fields for diagnosis data -->
                <input type="hidden" id="diagnosisData" name="diagnosisData">
                <input type="hidden" id="timestamp" name="timestamp">

                <button type="submit" class="inquiry-submit" id="submitInquiryBtn" aria-label="상담 신청 제출하기">상담 신청하기</button>
            </form>

            <div id="inquirySuccess" class="inquiry-success" style="display: none;" role="alert" aria-live="polite">
                <div class="success-icon" aria-hidden="true">✓</div>
                <h3 class="success-title">상담 신청이 완료되었습니다</h3>
                <p class="success-message">입력하신 이메일로 상세 안내를 보내드리겠습니다.<br>빠른 시일 내에 담당자가 연락드리겠습니다.</p>
                <button class="inquiry-close-btn" id="closeSuccessBtn" aria-label="확인 및 닫기">확인</button>
            </div>
        </div>
    </div>

    <script src="logger.js?v=1"></script>
    <script src="leadership-assessment.js?v=14"></script>
    <script src="team-compatibility.js?v=14"></script>
    <script src="storage-manager.js?v=1"></script>
    <script src="analytics-manager.js?v=1"></script>
    <script src="mobile-native.js?v=22"></script>
    <script src="app-controller.js?v=6"></script>
    <script>
        // Global Error Handler
        window.addEventListener('error', function(event) {
            console.error('전역 에러 발생:', event.error);
            showErrorMessage('일시적인 오류가 발생했습니다. 페이지를 새로고침해주세요.');
        });

        window.addEventListener('unhandledrejection', function(event) {
            console.error('처리되지 않은 Promise 거부:', event.reason);
            showErrorMessage('데이터 처리 중 오류가 발생했습니다.');
        });

        function showErrorMessage(message) {
            // 기존 에러 메시지가 있다면 제거
            const existingError = document.querySelector('.error-toast');
            if (existingError) {
                existingError.remove();
            }

            // 에러 토스트 생성
            const errorToast = document.createElement('div');
            errorToast.className = 'error-toast';
            errorToast.textContent = message;
            errorToast.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #ef4444, #dc2626);
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
                z-index: 10000;
                font-weight: 500;
                animation: slideDown 0.3s ease;
            `;

            document.body.appendChild(errorToast);

            // 3초 후 자동 제거
            setTimeout(() => {
                errorToast.style.animation = 'slideUp 0.3s ease';
                setTimeout(() => errorToast.remove(), 300);
            }, 3000);
        }

        // 애니메이션 스타일 추가
        if (!document.querySelector('#error-animations')) {
            const style = document.createElement('style');
            style.id = 'error-animations';
            style.textContent = `
                @keyframes slideDown {
                    from { transform: translate(-50%, -100%); opacity: 0; }
                    to { transform: translate(-50%, 0); opacity: 1; }
                }
                @keyframes slideUp {
                    from { transform: translate(-50%, 0); opacity: 1; }
                    to { transform: translate(-50%, -100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        }

        // ========================================
        // Security Utils
        // ========================================
        const SecurityUtils = {
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            },
            sanitizeMemberName(name) {
                if (typeof name !== 'string') return '';
                const maxLength = 50;
                let sanitized = name.trim().slice(0, maxLength);
                sanitized = sanitized.replace(/[^가-힣a-zA-Z0-9\s,]/g, '');
                return this.escapeHtml(sanitized);
            },
            parseMultipleNames(input) {
                if (!input || typeof input !== 'string') return [];
                const names = input
                    .split(/[,\s]+/)
                    .map(name => this.sanitizeMemberName(name))
                    .filter(name => name.length > 0)
                    .slice(0, 10);
                return names;
            },
            validateScore(value) {
                // LeadershipAssessment의 정적 메서드 사용 (검증 로직 통합)
                if (typeof LeadershipAssessment !== 'undefined' && LeadershipAssessment.validateScore) {
                    return LeadershipAssessment.validateScore(value);
                }
                // Fallback (LeadershipAssessment 로드 전)
                const num = typeof value === 'number' ? value : parseInt(value, 10);
                if (isNaN(num) || num < 1 || num > 6) {
                    return null;
                }
                return num;
            }
        };

        // ========================================
        // Application Controller
        // ========================================

        // 하위 호환성을 위한 네임스페이스 (전역 변수 오염 방지)
        const LinkLiteApp = {
            app: null,
            assessment: null,
            teamCompatibility: null,
            mobileNav: null,
            mobileInput: null
        };

        // 전역 접근을 위한 alias (하위 호환성)
        let app = null;
        let assessment = null;
        let teamCompatibility = null;
        let mobileNav = null;
        let mobileInput = null;

        // 페이지 로드 시 초기화 - DOMContentLoaded 대기
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('=== 초기화 디버깅 시작 ===');

            // 필수 클래스 로드 확인
            const requiredClasses = {
                'LeadershipAssessment': typeof LeadershipAssessment,
                'TeamCompatibility': typeof TeamCompatibility,
                'StorageManager': typeof StorageManager,
                'AnalyticsManager': typeof AnalyticsManager,
                'MobileNativeInput': typeof MobileNativeInput,
                'MobileNavigationManager': typeof MobileNavigationManager,
                'AppController': typeof AppController,
                'EventManager': typeof EventManager
            };

            console.log('클래스 로드 상태:', requiredClasses);

            // 누락된 클래스 확인
            const missingClasses = Object.entries(requiredClasses)
                .filter(([name, type]) => type === 'undefined')
                .map(([name]) => name);

            if (missingClasses.length > 0) {
                console.error('❌ 누락된 클래스:', missingClasses);
                alert(`필수 클래스가 로드되지 않았습니다:\n${missingClasses.join('\n')}\n\n페이지를 새로고침하거나 캐시를 지워주세요.`);
                return;
            }

            console.log('✓ 모든 필수 클래스 로드 완료');

            try {
                // 네임스페이스를 통한 초기화
                LinkLiteApp.app = new AppController();
                // 하위 호환성을 위한 전역 변수 할당
                app = LinkLiteApp.app;
                window.app = LinkLiteApp.app;
                console.log('✓ AppController 인스턴스 생성 완료');

                await LinkLiteApp.app.init();
                console.log('✓ AppController 초기화 완료');
            } catch (error) {
                console.error('❌ AppController 초기화 실패:', error);
                alert('앱 초기화 중 오류가 발생했습니다.\n\n에러 내용: ' + error.message + '\n\n브라우저 콘솔을 확인해주세요.');
                return;
            }

            // 전역 함수를 app 메서드에 연결 (기존 코드 호환성 유지)
            window.startAssessment = () => app.startAssessment();
            window.resetAssessment = () => app.resetAssessment();
            window.nextQuestion = () => app.nextQuestion();
            window.previousQuestion = () => app.previousQuestion();
            window.selectScore = (score) => app.recordScore(score);
            window.showResultsPage = () => app.showResultsPage();
            window.toggleFollowershipType = (id) => app.toggleFollowershipType(id);
            window.showSection = (id) => app.showSection(id);

            // 하위 호환성을 위한 전역 변수 노출 (점진적 제거 예정)
            assessment = app.assessment;
            teamCompatibility = app.teamCompatibility;
            window.assessment = app.assessment;
            window.teamCompatibility = app.teamCompatibility;
            window.storageManager = app.storageManager;
            window.analyticsManager = app.analyticsManager;

            // ========================================
            // Event Listeners - onclick 제거 후 addEventListener로 등록
            // ========================================

            // 진단 시작 버튼
            const startBtn = document.getElementById('startBtn');
            if (startBtn) {
                app.eventManager.add(startBtn, 'click', () => app.startAssessment());
            }

            // 진단 화면 네비게이션
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            if (prevBtn) {
                app.eventManager.add(prevBtn, 'click', () => app.previousQuestion());
            }
            if (nextBtn) {
                app.eventManager.add(nextBtn, 'click', () => {
                    console.log('=== 다음 버튼 클릭됨 ===');
                    console.log('버튼 disabled:', nextBtn.disabled);
                    app.nextQuestion();
                });
            }

            // 팔로워십 선택 화면 네비게이션
            const backToAssessmentBtn = document.getElementById('backToAssessmentBtn');
            const showResultsBtn = document.getElementById('showResultsBtn');
            if (backToAssessmentBtn) {
                app.eventManager.add(backToAssessmentBtn, 'click', () => app.showSection('assessment'));
            }
            if (showResultsBtn) {
                app.eventManager.add(showResultsBtn, 'click', () => {
                    console.log('=== 결과 보기 버튼 클릭됨 ===');
                    console.log('버튼 disabled 상태:', showResultsBtn.disabled);
                    console.log('선택된 팔로워십:', app.state.selectedFollowers);
                    app.showResultsPage();
                });
            }

            // 결과 화면 버튼
            const openInquiryBtn = document.getElementById('openInquiryBtn');
            const retakeBtn = document.getElementById('retakeBtn');
            if (openInquiryBtn) {
                app.eventManager.add(openInquiryBtn, 'click', () => openInquiryModal());
            }
            if (retakeBtn) {
                app.eventManager.add(retakeBtn, 'click', () => app.resetAssessment());
            }

            // 문의 모달 버튼
            const closeInquiryBtn = document.getElementById('closeInquiryBtn');
            const closeSuccessBtn = document.getElementById('closeSuccessBtn');
            const submitInquiryBtn = document.getElementById('submitInquiryBtn');
            const consentDetailBtn = document.getElementById('consentDetailBtn');

            if (closeInquiryBtn) {
                app.eventManager.add(closeInquiryBtn, 'click', () => closeInquiryModal());
            }
            if (closeSuccessBtn) {
                app.eventManager.add(closeSuccessBtn, 'click', () => closeInquiryModal());
            }
            // 폼 제출 이벤트 처리
            const inquiryFormElement = document.getElementById('inquiryForm');
            if (inquiryFormElement) {
                app.eventManager.add(inquiryFormElement, 'submit', (e) => submitInquiry(e));
            }
            if (consentDetailBtn) {
                app.eventManager.add(consentDetailBtn, 'click', () => toggleConsentDetail());
            }

            // 모달 외부 클릭 시 닫기
            const inquiryModal = document.getElementById('inquiryModal');
            if (inquiryModal) {
                app.eventManager.add(inquiryModal, 'click', (e) => {
                    if (e.target === inquiryModal) {
                        closeInquiryModal();
                    }
                });
            }

            console.log('✓ 이벤트 리스너 등록 완료');
        });

        // ========================================
        // Utility Functions
        // ========================================

        function getCategoryName(category) {
            const names = {
                'sharing': '공유 및 참여',
                'interaction': '상호작용',
                'growth': '성장지향'
            };
            return names[category] || category;
        }

        // ========================================
        // Results Display Functions
        // ========================================

        // DEPRECATED: AppController._displayLeadershipResults()로 이동됨
        // 하위 호환성을 위한 래퍼 함수
        function showResults() {
            console.warn('⚠️ showResults()는 deprecated됨 - AppController가 직접 호출함');
            // AppController.showResultsPage()에서 직접 처리하므로 여기서는 아무것도 하지 않음
        }

        // 래퍼 함수: updateRadarChart (AppController로 이동됨)
        function updateRadarChart(scores) {
            if (window.app) {
                app._updateRadarChart(scores);
            }
        }

        // 래퍼 함수: loadLeadershipTips (AppController로 이동됨)
        function loadLeadershipTips(leadershipCode) {
            if (window.app) {
                app._loadLeadershipTips(leadershipCode);
            }
        }

        // Link 팀 진단 문의 모달 함수
        function openInquiryModal() {
            const modal = document.getElementById('inquiryModal');
            const form = document.getElementById('inquiryForm');
            const success = document.getElementById('inquirySuccess');

            // 폼 초기화
            document.getElementById('inquiryEmail').value = '';
            document.getElementById('inquiryName').value = '';
            document.getElementById('inquiryCompany').value = '';
            document.getElementById('inquiryTeamSize').value = '';

            form.style.display = 'block';
            success.style.display = 'none';
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeInquiryModal() {
            const modal = document.getElementById('inquiryModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        async function submitInquiry(e) {
            e.preventDefault();

            const form = document.getElementById('inquiryForm');
            const email = document.getElementById('inquiryEmail').value.trim();
            const name = document.getElementById('inquiryName').value.trim();
            const phone = document.getElementById('inquiryPhone').value.trim();
            const company = document.getElementById('inquiryCompany').value.trim();
            const teamSize = document.getElementById('inquiryTeamSize').value;
            const consentChecked = document.getElementById('inquiryConsent').checked;

            // 이메일 필수 검증
            if (!email) {
                alert('이메일을 입력해주세요.');
                return;
            }

            // 이메일 형식 검증
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('올바른 이메일 형식을 입력해주세요.');
                return;
            }

            // 진단 데이터 수집
            let diagnosisData = null;
            if (consentChecked && window.app && window.app.assessment) {
                try {
                    const result = window.app.assessment.determineLeadershipType();
                    diagnosisData = {
                        leadershipType: result.code,
                        leadershipName: result.type.name,
                        scores: {
                            sharing: result.scores.sharing.toFixed(2),
                            interaction: result.scores.interaction.toFixed(2),
                            growth: result.scores.growth.toFixed(2)
                        },
                        selectedFollowerTypes: window.app.state.selectedFollowers || []
                    };
                } catch (e) {
                    if (typeof logger !== 'undefined') {
                        logger.error('진단 데이터 수집 실패:', e);
                    }
                    // 진단 데이터 없이 진행
                    diagnosisData = null;
                }
            }

            // Hidden fields에 데이터 채우기
            document.getElementById('diagnosisData').value = diagnosisData ? JSON.stringify(diagnosisData, null, 2) : '진단 결과 공유 미동의';
            document.getElementById('timestamp').value = new Date().toISOString();

            // GA4 이벤트 추적
            if (window.app && window.app.analyticsManager) {
                window.app.analyticsManager.trackTeamDiagnosisCTA();
            }

            try {
                // Netlify Forms 제출
                const formData = new FormData(form);
                const response = await fetch('/', {
                    method: 'POST',
                    headers: { "Content-Type": "application/x-www-form-urlencoded" },
                    body: new URLSearchParams(formData).toString()
                });

                if (response.ok) {
                    // 성공 화면 표시
                    form.style.display = 'none';
                    document.getElementById('inquirySuccess').style.display = 'block';

                    if (typeof logger !== 'undefined') {
                        logger.log('✅ 팀 진단 상담 신청 완료:', {
                            email, name, phone, company, teamSize,
                            consentChecked,
                            diagnosisDataIncluded: !!diagnosisData
                        });
                    }
                } else {
                    throw new Error('폼 제출 실패: ' + response.status);
                }
            } catch (error) {
                if (typeof logger !== 'undefined') {
                    logger.error('❌ 폼 제출 오류:', error);
                }
                alert('상담 신청 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.\n\n오류 내용: ' + error.message);
            }
        }

        function toggleConsentDetail() {
            const detail = document.getElementById('consentDetail');
            if (detail.style.display === 'none') {
                detail.style.display = 'block';
            } else {
                detail.style.display = 'none';
            }
        }

        // ========================================
        // Keyboard Shortcuts for Testing
        // ========================================

        // 테스트용 단축키 기능 (AppController 메서드 사용)
        document.addEventListener('keydown', function(e) {
            console.log('키 이벤트 감지:', e.key, 'Ctrl:', e.ctrlKey, 'Meta:', e.metaKey, 'Shift:', e.shiftKey);

            // 진단 화면에서만 작동
            const assessmentActive = document.getElementById('assessment').classList.contains('active');
            console.log('진단 화면 활성:', assessmentActive, 'window.app 존재:', !!window.app);

            if (assessmentActive && window.app) {
                console.log('✓ 단축키 처리 시작');
                // Ctrl/Cmd + 숫자키로 점수 자동 입력
                if ((e.ctrlKey || e.metaKey) && e.key >= '1' && e.key <= '6') {
                    e.preventDefault();
                    const value = parseInt(e.key);
                    console.log('점수 입력 시도:', value);

                    app.selectScore(value);
                    console.log('점수 입력 완료:', value);
                }

                // Ctrl/Cmd + Shift + F: 4.5 기준 랜덤 점수로 채우기
                if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key.toLowerCase() === 'f') {
                    e.preventDefault();
                    console.log('✓ Cmd+Shift+F 감지: 4.5 기준 랜덤 점수 채우기 시작');
                    fillAllQuestionsRandomly();
                    console.log('✓ fillAllQuestionsRandomly() 완료');
                }
                // Ctrl/Cmd + F: 모든 질문을 5점으로 빠르게 채우기
                else if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'f') {
                    e.preventDefault();
                    console.log('모든 질문 5점 채우기 시작');
                    fillAllQuestionsWithScore(5);
                }

                // Ctrl/Cmd + H: 모든 질문을 고점수(6점)로 빠르게 채우기
                if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'h') {
                    e.preventDefault();
                    console.log('모든 질문 6점 채우기 시작');
                    fillAllQuestionsWithScore(6);
                }

                // Ctrl/Cmd + L: 모든 질문을 저점수(2점)로 빠르게 채우기
                if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'l') {
                    e.preventDefault();
                    console.log('모든 질문 2점 채우기 시작');
                    fillAllQuestionsWithScore(2);
                }

                // 추가: 단순한 숫자키만으로도 점수 입력 가능 (Ctrl/Cmd 없이)
                if (!e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey && e.key >= '1' && e.key <= '6') {
                    const value = parseInt(e.key);
                    console.log('단순 숫자키 입력:', value);

                    app.selectScore(value);
                    console.log('단순 숫자키로 점수 입력 완료:', value);
                }
            }
        });

        // 모든 질문을 특정 점수로 채우는 함수 (AppController 사용)
        function fillAllQuestionsWithScore(score) {
            if (!window.app) {
                console.error('AppController가 초기화되지 않았습니다');
                return;
            }

            const totalQuestions = app.assessment.getTotalQuestions();

            // 모든 질문에 점수 기록
            for (let i = 0; i < totalQuestions; i++) {
                const question = app.assessment.getQuestion(i);
                app.assessment.recordResponse(question.id, score);
            }

            // 현재 질문의 UI 업데이트
            app.selectScore(score);

            // 안내 메시지
            console.log(`모든 질문이 ${score}점으로 설정되었습니다. 이제 '다음' 버튼을 눌러 결과를 확인하거나 다음 질문으로 넘어가세요.`);
        }

        // 모든 질문을 4.5 기준 랜덤 점수로 채우는 함수 (AppController 사용)
        function fillAllQuestionsRandomly() {
            if (!window.app) {
                console.error('AppController가 초기화되지 않았습니다');
                return;
            }

            const totalQuestions = app.assessment.getTotalQuestions();
            const baseScore = 4.5;
            const scores = [];

            // 모든 질문에 랜덤 점수 생성 및 기록
            for (let i = 0; i < totalQuestions; i++) {
                const question = app.assessment.getQuestion(i);

                // 4.5를 중심으로 ±0.5~1.5 범위의 랜덤 값 생성
                // 결과: 3~6 범위의 점수 (1~6 사이로 제한)
                const randomOffset = (Math.random() * 2 - 1) * 1.5; // -1.5 ~ +1.5
                let randomScore = baseScore + randomOffset;

                // 1~6 범위로 제한하고 반올림
                randomScore = Math.max(1, Math.min(6, Math.round(randomScore)));

                app.assessment.recordResponse(question.id, randomScore);
                scores.push(randomScore);
            }

            // 현재 질문의 UI 업데이트
            const currentScore = scores[app.state.currentQuestion];
            app.selectScore(currentScore);

            // 점수 분포 확인
            const avg = (scores.reduce((a, b) => a + b, 0) / scores.length).toFixed(2);
            console.log(`모든 질문이 4.5 기준 랜덤 점수로 설정되었습니다.`);
            console.log(`평균: ${avg}점, 범위: ${Math.min(...scores)}~${Math.max(...scores)}점`);
            console.log(`점수 분포:`, scores);
        }

        // 단축키 안내 함수 (콘솔에서 확인 가능)
        window.showTestShortcuts = function() {
            console.log(`
=== 테스트용 단축키 안내 ===
진단 화면에서 사용 가능:

🔢 점수 입력:
• 1~6 숫자키: 현재 질문에 해당 점수 입력 (간단!)
• Ctrl/Cmd + 1~6: 현재 질문에 해당 점수 입력

⚡ 빠른 채우기:
• Ctrl/Cmd + Shift + F: 4.5 기준 랜덤 점수로 채우기 (현실적인 테스트)
• Ctrl/Cmd + F: 모든 질문을 5점으로 채우기
• Ctrl/Cmd + H: 모든 질문을 고점수(6점)로 채우기
• Ctrl/Cmd + L: 모든 질문을 저점수(2점)로 채우기

💡 팁: 숫자키 1~6만 눌러도 점수가 입력됩니다!

콘솔에서 showTestShortcuts() 호출하면 이 안내를 다시 볼 수 있습니다.
========================
            `);
        };

        // 성능 모니터링
        if ('PerformanceObserver' in window) {
            const perfObserver = new PerformanceObserver((entryList) => {
                for (const entry of entryList.getEntries()) {
                    if (entry.entryType === 'navigation') {
                        console.log('페이지 로드 시간:', entry.loadEventEnd - entry.fetchStart, 'ms');
                    }
                    if (entry.entryType === 'paint') {
                        console.log(entry.name + ':', entry.startTime, 'ms');
                    }
                }
            });

            try {
                perfObserver.observe({ entryTypes: ['navigation', 'paint'] });
            } catch (e) {
                // Safari may not support all entry types
                console.log('성능 모니터링 일부 미지원');
            }
        }

        // 모바일 네비게이션 초기화 함수
        function initMobileNav() {
            if (window.innerWidth <= 768) {
                if (!mobileNav) {
                    mobileNav = new MobileNavigationManager();
                }
                // 진단 또는 팔로워십 페이지가 아니면 숨김
                const isAssessmentPage = document.getElementById('assessment').classList.contains('active');
                const isFollowershipPage = document.getElementById('followership').classList.contains('active');
                if (!isAssessmentPage && !isFollowershipPage) {
                    mobileNav.hide();
                }
            } else {
                // 데스크톱 화면에서는 모바일 네비게이션 숨김
                if (mobileNav) {
                    mobileNav.hide();
                }
            }
        }

        // 초기화
        document.addEventListener('DOMContentLoaded', function() {
            initMobileNav();

            // 개발 모드일 때 단축키 안내 표시
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                console.log('🚀 개발 모드: 테스트용 단축키가 활성화되었습니다. showTestShortcuts()를 입력하여 단축키를 확인하세요.');
            }

        });

        // 화면 크기 변경 시 모바일 네비게이션 재초기화
        let resizeTimeout;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                initMobileNav();
            }, 100);
        });
    </script>
</body>
</html>